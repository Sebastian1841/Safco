# ThingsBoard SAFCO EJEMPLO

Una librer√≠a Python simple para consultar datos de telemetr√≠a desde ThingsBoard por rango de fechas.

## üìã Descripci√≥n

Esta librer√≠a permite consultar datos de dos dispositivos diferentes en ThingsBoard, obteniendo las variables de telemetr√≠a por rangos de fechas espec√≠ficos. Es ideal para generar reportes de consumo de combustible.

## üöÄ Caracter√≠sticas

- **Autenticaci√≥n autom√°tica** con ThingsBoard
- **Consulta por rangos de fechas** flexibles
- **Dos dispositivos soportados**: FIJO y M√≥vil
- **Conversi√≥n autom√°tica** de pulsos a litros
- **Interfaz interactiva** para consultas manuales
- **Manejo de errores** robusto

## üîß Instalaci√≥n

### Requisitos
```bash
pip install requests

## üîß Configuraci√≥n

- **El c√≥digo incluye toda la configuraci√≥n necesaria:**
 -  # Configuraci√≥n de conexi√≥n
    url = "https://sinergychile.cl"
    usuario = "remisrea@cog.cl"
    password = "nuevavida2050"

- **# Dispositivos**
    dispositivo1 = "52906fe0-a5d5-11f0-9dd9-bb6adf6472c1"  # FIJO
    dispositivo2 = "39dd8c70-6cb0-11f0-9c9f-ebe52b51bbe5"  # M√≥vil

 ## üîß  Variables Obtenidas

 Dispositivo FIJO

    Litros_total - Litros de combustible consumidos

    iButton_total - Identificador del usuario (iButton)

Dispositivo M√≥vil

    pulsos_total - Pulsos del contador de combustible

    ibutton - Identificador del usuario (iButton)

Nota: Los pulsos se convierten autom√°ticamente a litros usando el factor 19.86
üõ†Ô∏è Uso B√°sico
Ejemplo 1: Uso Directo

from thingsboard_client import ThingsBoardSimple

# Crear instancia del cliente
tb = ThingsBoardSimple()

# Consultar un d√≠a espec√≠fico
datos = tb.consultar_por_fechas("2024-01-15", "2024-01-15")

# Mostrar resultados
tb.mostrar_resultados(datos)

Ejemplo 2: Consultar Rango Personalizado

# Consultar una semana
datos = tb.consultar_por_fechas("2024-01-10", "2024-01-16")

# Consultar un mes completo
datos = tb.consultar_por_fechas("2024-01-01", "2024-01-31")

Ejemplo 3: Uso Interactivo
# Ejecutar consulta interactiva
tb.consulta_interactiva()

üìù M√©todos Principales
consultar_por_fechas(fecha_inicio, fecha_fin)

Consulta datos de ambos dispositivos en el rango especificado.

Par√°metros:

    fecha_inicio (str): Fecha inicial en formato "YYYY-MM-DD"

    fecha_fin (str): Fecha final en formato "YYYY-MM-DD"

Retorna:

    dict: Diccionario con datos de ambos dispositivos

mostrar_resultados(datos)

Muestra los resultados de forma legible en la consola.

Par√°metros:

    datos (dict): Datos obtenidos de consultar_por_fechas

üéØ Ejemplos de Consulta
Consultar un Solo D√≠a

datos = tb.consultar_por_fechas("2024-01-15", "2024-01-15")

Consultar Varios D√≠as

# Una semana
datos = tb.consultar_por_fechas("2024-01-10", "2024-01-16")

# 15 d√≠as
datos = tb.consultar_por_fechas("2024-01-01", "2024-01-15")

# Mes completo
datos = tb.consultar_por_fechas("2024-01-01", "2024-01-31")

 Salida de Ejemplo

 Consultando del 2024-01-15 al 2024-01-15
==================================================

üîπ FIJO - LITROS TOTALES
   Registros encontrados: 8
   2024-01-15 10:30:00 - Litros: 45.2 - iButton: 0146FF1901000033
   2024-01-15 14:15:00 - Litros: 32.1 - iButton: 016E818A01000082

üîπ M√≥vil - PULSOS
   Registros encontrados: 5
   2024-01-15 09:45:00 - Pulsos: 895 - Litros: 45.07 - iButton: 01C44B1A0100006F

   üîÑ Flujo de Trabajo

    Autenticaci√≥n: Login autom√°tico con las credenciales configuradas

    Conversi√≥n de fechas: Transforma fechas a timestamps de ThingsBoard

    Consulta API: Obtiene datos de telemetr√≠a de ambos dispositivos

    Procesamiento: Convierte pulsos a litros y formatea resultados

    Presentaci√≥n: Muestra datos de forma legible al usuario